<%- model_class = Chair -%>
<div class="page-header">
  <h1><%= t '.title', :default => model_class.model_name.human.pluralize.titleize %></h1>
</div>
<table class="table table-striped">
  <thead>
  <tr>
    <th><%= model_class.human_attribute_name(:id) %></th>
    <th><%= model_class.human_attribute_name(:name) %></th>
    <th><%= model_class.human_attribute_name(:created_at) %></th>
    <th><%= model_class.human_attribute_name(:status) %></th>
    <th><%= t '.actions', :default => t("helpers.actions") %></th>
  </tr>
  </thead>
  <tbody>
  <% @chairs.each do |chair| %>
      <tr>
        <td><%= link_to chair.id, chair_path(chair) %></td>
        <td><%= chair.name %></td>
        <td><%= chair.created_at %></td>

        <td>
          <% if current_user.chair == chair %>
            <% if current_user.is_wimi? %>
              <span class="label label-success"><%= I18n.t('roles.wimi.long', default: 'Research Assistant') %></span>
            <% else %>
              <span class="label label-warning"><%= I18n.t('status.pending', default: 'pending') %></span>
            <% end %>
          <% else %>
            <% if !current_user.is_wimi? && !current_user.is_superadmin? && current_user.chair_wimi.nil? %>
              <%= link_to I18n.t('chair.apply', default: 'Apply as Wimi'), chairs_apply_path(:chair => chair), :method => :post, :class => 'btn btn-default btn-xs' %>
            <% end %>
          <% end %>
        </td>

        <td>
          <% if !current_user.chair_wimi.nil? %>
            <% if (current_user.chair_wimi.admin || current_user.chair_wimi.representative) && (chair.id == current_user.chair_wimi.chair.id) %>
              <%= link_to I18n.t('chair.manage', default: 'Manage Chair'), chair_path(chair), :class => 'btn btn-warning btn-xs' %>
            <% end %>
          <% end %>
          <% if current_user.superadmin %>
            <%= link_to I18n.t('chair.edit', default: 'Edit Chair'), edit_chair_path(chair), :class => 'btn btn-warning btn-xs' %>
            <%= link_to I18n.t('chair.destroy', default: 'Destroy Chair'), chair_path(:id => chair), :method => :delete, :class => 'btn btn-danger btn-xs' %>
          <% end %>
        </td>

      </tr>
  <% end %>
  </tbody>
</table>
<% if current_user.superadmin %>
    <%= link_to t('.new', :default => t("helpers.links.new")),
                new_chair_path,
                :class => 'btn btn-primary' %>
<% end %>

